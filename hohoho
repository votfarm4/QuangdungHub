-- Blox Fruits Script: QUANGDUNGHUB VIP
-- Based on W-Azure architecture
-- Version: 5.0 | Loadstring: https://raw.githubusercontent.com/quangdunghub/script/main/quangdunghub.lua

local QuangDungHub = {
    Version = "5.0",
    Author = "quangdunghub",
    Discord = "discord.gg/quangdung"
}

-- Anti-ban & Anti-kick system
local SafeMode = true
local VirtualUser = game:GetService("VirtualUser")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Auto rejoin if kicked
game:GetService("Players").LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-- GUI Library (Kaitun style)
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("QUANGDUNGHUB VIP - BLOX FRUITS", "DarkTheme")

-- Main tabs
local Main = Window:NewTab("ðŸ  MAIN")
local Farming = Window:NewTab("ðŸŒ¾ FARMING")
local Auto = Window:NewTab("ðŸ¤– AUTO")
local Raid = Window:NewTab("âš”ï¸ RAID")
local Teleport = Window:NewTab("ðŸ“ TELEPORT")
local Misc = Window:NewTab("âš™ï¸ MISC")
local Settings = Window:NewTab("ðŸ”§ SETTINGS")

-- MAIN SECTION
local MainSection = Main:NewSection("General Features")
MainSection:NewToggle("Auto Farm Level", "Auto farm mobs for XP", function(state)
    getgenv().AutoFarm = state
    if state then
        spawn(function()
            while wait() and getgenv().AutoFarm do
                -- Auto farm logic
                pcall(function()
                    for i,v in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
                        if v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 then
                            repeat wait()
                                LocalPlayer.Character.HumanoidRootPart.CFrame = v.HumanoidRootPart.CFrame * CFrame.new(0, 20, 0)
                                game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("SetSpawnPoint")
                                game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("AttackEntity", v.Name)
                            until not getgenv().AutoFarm or v.Humanoid.Health <= 0
                        end
                    end
                end)
            end
        end)
    end
end)

MainSection:NewToggle("Auto New World", "Auto go to New World when reach level 700", function(state)
    getgenv().AutoNewWorld = state
end)

MainSection:NewToggle("Auto Third Sea", "Auto go to Third Sea when level 1500", function(state)
    getgenv().AutoThirdSea = state
end)

MainSection:NewButton("Max Stats", "Automatically allocate all stats to melee/defense", function()
    local args = {
        [1] = "AddPoint",
        [2] = "Melee",
        [3] = tonumber(LocalPlayer.Data.Points.Value)
    }
    game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer(unpack(args))
end)

-- FARMING SECTION
local FarmingSection = Farming:NewSection("Auto Farm Settings")
FarmingSection:NewDropdown("Select Farm Method", "Choose farming method", {"Normal", "Fast", "Safe", "Boss Farm"}, function(method)
    getgenv().FarmMethod = method
end)

FarmingSection:NewToggle("Auto Farm Sea Beasts", "Auto farm sea beasts", function(state)
    getgenv().AutoSeaBeast = state
end)

FarmingSection:NewToggle("Auto Farm Elite Hunter", "Auto farm elite pirates", function(state)
    getgenv().AutoElite = state
end)

FarmingSection:NewToggle("Auto Farm Boss", "Auto farm all bosses", function(state)
    getgenv().AutoBoss = state
    if state then
        spawn(function()
            while wait() and getgenv().AutoBoss do
                pcall(function()
                    for i,v in pairs(game:GetService("ReplicatedStorage"):GetChildren()) do
                        if string.find(v.Name, "Boss") then
                            if v:FindFirstChild("HumanoidRootPart") then
                                repeat wait()
                                    LocalPlayer.Character.HumanoidRootPart.CFrame = v.HumanoidRootPart.CFrame * CFrame.new(0, 20, 0)
                                    game:GetService("ReplicatedStorage").Remotes.CommF_:InvokeServer("AttackEntity", v.Name)
                                until not getgenv().AutoBoss or v.Humanoid.Health <= 0
                            end
                        end
                    end
                end)
            end
        end)
    end
end)

-- AUTO SECTION
local AutoSection = Auto:NewSection("Automation")
AutoSection:NewToggle("Auto Buy Haki", "Auto buy all haki colors", function(state)
    getgenv().AutoHaki = state
end)

AutoSection:NewToggle("Auto Buy Fighting Style", "Auto buy all fighting styles", function(state)
    getgenv().AutoFightingStyle = state
end)

AutoSection:NewToggle("Auto Random Fruit", "Auto eat random fruit", function(state)
    getgenv().AutoRandomFruit = state
end)

AutoSection:NewToggle("Auto Collect Chest", "Auto collect all chests", function(state)
    getgenv().AutoChest = state
end)

AutoSection:NewToggle("Auto Factory Farm", "Auto farm in factory", function(state)
    getgenv().AutoFactory = state
end)

-- RAID SECTION
local RaidSection = Raid:NewSection("Raid Features")
RaidSection:NewToggle("Auto Raid", "Auto start raid", function(state)
    getgenv().AutoRaid = state
end)

RaidSection:NewToggle("Auto Kill Law Boss", "Auto kill Law Raid boss", function(state)
    getgenv().AutoLaw = state
end)

RaidSection:NewToggle("Auto Next Island", "Auto go to next island in raid", function(state)
    getgenv().AutoNextIsland = state
end)

RaidSection:NewDropdown("Select Raid", "Choose raid type", {"Flame", "Ice", "Quake", "Light", "Dark", "String", "Rumble", "Sand", "Phoenix"}, function(raid)
    getgenv().SelectedRaid = raid
end)

-- TELEPORT SECTION
local TeleportSection = Teleport:NewSection("Teleports")
local Islands = {
    "Start Island", "Marine Starter", "Middle Town", "Jungle", "Pirate Village",
    "Desert", "Frozen Village", "Colosseum", "Prison", "Magma Village",
    "Underwater City", "Fountain City", "Sky Island 1", "Sky Island 2",
    "Sky Island 3", "Hot Island", "Cold Island", "Ice Castle", "Usopp's Island",
    "Green Bit", "Zou", "Kingdom of Rose", "Elf Village", "Flower Sea"
}

for _, island in pairs(Islands) do
    TeleportSection:NewButton(island, "Teleport to " .. island, function()
        local place
        if island == "Start Island" then
            place = CFrame.new(1071.2832, 16.3085976, 1426.86792)
        -- Add more coordinates for each island
        end
        if place then
            LocalPlayer.Character.HumanoidRootPart.CFrame = place
        end
    end)
end

-- MISC SECTION
local MiscSection = Misc:NewSection("Miscellaneous")
MiscSection:NewToggle("Auto Click", "Auto click for speed", function(state)
    getgenv().AutoClick = state
    if state then
        spawn(function()
            while wait(0.1) and getgenv().AutoClick do
                VirtualUser:CaptureController()
                VirtualUser:ClickButton1(Vector2.new())
            end
        end)
    end
end)

MiscSection:NewToggle("No Clip", "Walk through walls", function(state)
    getgenv().NoClip = state
    if state then
        spawn(function()
            while wait() and getgenv().NoClip do
                pcall(function()
                    for i,v in pairs(LocalPlayer.Character:GetDescendants()) do
                        if v:IsA("BasePart") then
                            v.CanCollide = false
                        end
                    end
                end)
            end
        end)
    end
end)

MiscSection:NewToggle("Infinite Energy", "Unlimited energy", function(state)
    getgenv().InfiniteEnergy = state
end)

MiscSection:NewToggle("Dodge No Cooldown", "No cooldown for dodge", function(state)
    getgenv().NoCooldownDodge = state
end)

MiscSection:NewButton("Rejoin Server", "Rejoin current server", function()
    local TeleportService = game:GetService("TeleportService")
    TeleportService:Teleport(game.PlaceId, LocalPlayer)
end)

MiscSection:NewButton("Server Hop", "Hop to different server", function()
    local Http = game:GetService("HttpService")
    local TPS = game:GetService("TeleportService")
    local API = "https://games.roblox.com/v1/games/%s/servers/Public?sortOrder=Desc&limit=100"
    
    local function Servers()
        local raw = game:HttpGet(API:format(game.PlaceId))
        return Http:JSONDecode(raw)
    end
    
    local data = Servers()
    if data and data.data then
        local servers = {}
        for _, v in next, data.data do
            if type(v) == "table" and v.playing ~= v.maxPlayers then
                table.insert(servers, v.id)
            end
        end
        
        if #servers > 0 then
            TPS:TeleportToPlaceInstance(game.PlaceId, servers[math.random(1, #servers)])
        end
    end
end)

-- SETTINGS SECTION
local SettingsSection = Settings:NewSection("Settings")
SettingsSection:NewKeybind("Toggle GUI", "Toggle the GUI visibility", Enum.KeyCode.RightShift, function()
    Library:ToggleUI()
end)

SettingsSection:NewSlider("WalkSpeed", "Change walk speed", 16, 500, 16, function(value)
    LocalPlayer.Character.Humanoid.WalkSpeed = value
end)

SettingsSection:NewSlider("JumpPower", "Change jump power", 50, 500, 50, function(value)
    LocalPlayer.Character.Humanoid.JumpPower = value
end)

SettingsSection:NewButton("Destroy GUI", "Remove GUI", function()
    Library:Destroy()
end)

-- NOTIFICATION
Library:Notify("QUANGDUNGHUB VIP Loaded Successfully!", 5)

-- ANTI-AFK
local VirtualInputManager = game:GetService("VirtualInputManager")
while wait(30) do
    pcall(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
        VirtualInputManager:SendKeyEvent(true, "W", false, game)
        wait(0.1)
        VirtualInputManager:SendKeyEvent(false, "W", false, game)
    end)
end

-- AUTO UPDATE
local function UpdateScript()
    local success, newScript = pcall(function()
        return game:HttpGet("https://raw.githubusercontent.com/quangdunghub/script/main/quangdunghub.lua")
    end)
    
    if success then
        local currentVersion = QuangDungHub.Version
        local pattern = 'Version = "(%d+%.%d+)"'
        local newVersion = string.match(newScript, pattern)
        
        if newVersion and newVersion > currentVersion then
            Library:Notify("Update available! Downloading v" .. newVersion, 5)
            writefile("quangdunghub_updated.lua", newScript)
        end
    end
end

spawn(function()
    while wait(300) do
        UpdateScript()
    end
end)

return QuangDungHub
