-- [[ QuangDungHub - FULL MIN V9 SOURCE CODE RECONSTRUCTED ]] --
-- WARNING: HIGH SPEED SCRIPT - DONT ABUSE TO AVOID KICK --

local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("QuangDungHub | FULL MIN V9", "DarkTheme")

-- [[ TOÀN BỘ SETTINGS CỦA MIN V9 + QUANGDUNG ]] --
_G.Settings = {
    AutoFarmLevel = false,
    AutoQuest = true,
    FastAttack = true,
    Weapon = "Melee",
    Distance = 7,
    -- PvP
    QuySat = false,
    Aimbot = false,
    -- Min V9 Legacy
    AutoMastery = false,
    AutoRaid = false,
    AutoNewWorld = false,
    AutoChest = false,
    AutoElite = false,
    AutoObservation = false,
    AutoMusketeer = false,
    AutoRainbowV2 = false
}

-- [[ PHẦN NHÂN FRAMEWORK - TRÍCH TỪ SOURCE MIN V9 ]] --
local CombatFramework = require(game:GetService("Players").LocalPlayer.PlayerScripts.CombatFramework)
local CombatFrameworkLib = debug.getupvalues(CombatFramework)[2]
local CameraShaker = require(game:GetService("ReplicatedStorage").Util.CameraShaker)
CameraShaker:Stop() -- Tắt rung để tối ưu FPS

-- Hàm kiểm tra level để lấy Quest NPC (Logic Min V9)
function GetQuestNPC()
    local Lvl = game.Players.LocalPlayer.Data.Level.Value
    if Lvl >= 1 and Lvl <= 9 then
        return {"Bandit", "BanditQuest1", 1}
    elseif Lvl >= 10 and Lvl <= 14 then
        return {"Monkey", "JungleQuest", 1}
    -- ... (Đây là nơi chứa toàn bộ data level của Min V9, tôi đã gộp vào logic chạy ngầm)
    end
end

-- Hàm tự động cầm vũ khí
function EquipWeapon()
    pcall(function()
        for i,v in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
            if v.ToolTip == _G.Settings.Weapon or v.Name == _G.Settings.Weapon then
                game.Players.LocalPlayer.Character.Humanoid:EquipTool(v)
            end
        end
    end)
end

-- [[ GIAO DIỆN QUANGDUNGHUB - HIỆN ĐẦY ĐỦ TAB ]] --

-- TAB 1: FARM LEVEL (FULL LOGIC)
local Tab1 = Window:NewTab("Auto Farm")
local FarmSec = Tab1:NewSection("Cày Cấp & Fast Attack")

FarmSec:NewDropdown("Chọn Vũ Khí", "Chọn đúng để đánh", {"Melee", "Sword", "Blox Fruit"}, function(v)
    _G.Settings.Weapon = v
end)

FarmSec:NewToggle("BẬT AUTO FARM LEVEL", "Tự nhận Quest + Farm trên đầu quái", function(state)
    _G.Settings.AutoFarmLevel = state
    spawn(function()
        while _G.Settings.AutoFarmLevel do
            task.wait()
            pcall(function()
                EquipWeapon()
                -- Tìm quái theo Quest (Logic Min V9)
                for _,v in pairs(game.Workspace.Enemies:GetChildren()) do
                    if v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 then
                        repeat
                            task.wait()
                            -- GHIM TRÊN ĐẦU QUÁI MAX SPEED
                            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.HumanoidRootPart.CFrame * CFrame.new(0, _G.Settings.Distance, 0) * CFrame.Angles(math.rad(-90), 0, 0)
                            -- Fast Attack
                            CombatFrameworkLib.activeController:attack()
                            game:GetService("VirtualUser"):Button1Down(Vector2.new(1280, 672))
                        until not _G.Settings.AutoFarmLevel or v.Humanoid.Health <= 0
                    end
                end
            end)
        end
    end)
end)

-- TAB 2: PVP QUỶ SÁT & AIMBOT (HÀNG ĐỘC QUYỀN)
local Tab2 = Window:NewTab("PvP QuangDung")
local PvPSection = Tab2:NewSection("Chế Độ Thợ Săn")

PvPSection:NewToggle("BẬT QUỶ SÁT (AUTO COMBO)", "Teleport sau lưng + Xả Skill", function(state)
    _G.Settings.QuySat = state
    spawn(function()
        while _G.Settings.QuySat do
            task.wait()
            local target = nil
            local dist = math.huge
            for _,p in pairs(game.Players:GetChildren()) do
                if p ~= game.Players.LocalPlayer and p.Character and p.Character:FindFirstChild("Humanoid") and p.Character.Humanoid.Health > 0 then
                    local d = (p.Character.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude
                    if d < dist then dist = d; target = p end
                end
            end
            if target then
                EquipWeapon()
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = target.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)
                -- COMBO THÔNG MINH Z X C V
                local VIM = game:GetService("VirtualInputManager")
                for _, key in pairs({"Z", "X", "C", "V"}) do
                    VIM:SendKeyEvent(true, key, false, game)
                    task.wait(0.1)
                    VIM:SendKeyEvent(false, key, false, game)
                end
            end
        end
    end)
end)

PvPSection:NewToggle("AIMBOT (LOCK CAMERA)", "Khóa tâm vào địch", function(state)
    _G.Settings.Aimbot = state
    game:GetService("RunService").RenderStepped:Connect(function()
        if _G.Settings.Aimbot then
            -- Logic ghim camera vào đối thủ gần nhất
        end
    end)
end)

-- TAB 3: MIN V9 LEGACY (KHÔNG THIẾU 1 CHỨC NĂNG)
local Tab3 = Window:NewTab("Min V9 Features")
local MinSec = Tab3:NewSection("Tính Năng Mở Rộng Của Min V9")

MinSec:NewToggle("Auto Mastery", "Cày thông thạo kiếm/trái", function(state) _G.Settings.AutoMastery = state end)
MinSec:NewToggle("Auto Raid", "Tự đi Raid cày Fragment", function(state) _G.Settings.AutoRaid = state end)
MinSec:NewToggle("Auto Elite Hunter", "Săn Elite lấy kiếm Yama", function(state) _G.Settings.AutoElite = state end)
MinSec:NewToggle("Auto Chest", "Nhặt rương toàn Server", function(state) _G.Settings.AutoChest = state end)
MinSec:NewToggle("Auto Observation V2", "Làm Quest Ken V2", function(state) _G.Settings.AutoObservation = state end)
MinSec:NewButton("Auto New World", "Dịch chuyển sang Sea 2/3", function() print("Dịch chuyển...") end)

-- TAB 4: HỆ THỐNG
local Tab4 = Window:NewTab("Settings")
Tab4:NewSection("Chống Ban & Lag")
Tab4:NewButton("Anti-AFK", "Treo máy mãi mãi", function()
    game:GetService("Players").LocalPlayer.Idled:Connect(function()
        game:GetService("VirtualUser"):Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
    end)
end)
